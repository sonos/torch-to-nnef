# axes should be all dim except norm dim
fragment weight_norm( v: tensor<scalar>, g: tensor<scalar>, axes: integer[]) -> ( output: tensor<scalar> )
{
     output =  v * (g / sqrt(sum_reduce(sqr(v), axes = axes)));
}
